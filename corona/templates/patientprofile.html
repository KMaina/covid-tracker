{% extends 'base.html' %}
{% load bootstrap4 %}
{% include 'material/includes/material_css.html' %}
{% include 'material/includes/material_js.html' %}
<script src="https://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
{% block content %}
{{block.super}}
    {% include "navbar.html" %}
    <style>
      
    </style>
    <div class="row">
        <div class="col"></div>
        <div class="col-md-8" style="background: #b1e8fb77; "> 
            <div class="container" style="margin-top: 30px; text-align: center;">            
                <img src="{{ profile.photo_url|default_if_none:'https://icon-library.net/images/patient-icon/patient-icon-25.jpg' }}" alt="profile picture" style=" width:225px; height: 225px; border-radius:50%;">                              
                <a href="{% url 'editprofile' %}"><button style="display: inline-block;" class="btn btn-primary">Update Profile</button></a>
                <p>{{current_user.username}}</p>
            </div>
            <div class="container" style="margin-left: 12%; margin-top: 30px;">
                <h6 style="display: inline-block; padding-right: 15%;">Name: <span style="font-size: 20px;">{{profile.name}}</span></h6>
                <h6 style="display: inline-block;">Email: <span style="font-size: 20px;">{{profile.user.email}}</span></h6>
            </div>            
            <h6 style="display: inline-block;margin-left: 15%; padding-right:15%;">Phone no.: <span style="font-size: 20px;">{{profile.phone}}</span></h6>
            <h6 style="display: inline-block;">Status: <span style="font-size: 20px;">Not-set</span></h6>            
            <h6 style="display: inline-block;margin-left: 15%; padding-right:15%;">Location: <span style="font-size: 20px;">{{profile.location}}</span></h6>
            <h6 style="display: inline-block;">Treatment: <span style="font-size: 20px;">Not-set</span></h6>            
            <div class="row" style="margin-top: 30px;">
              <div class="col" id="map">
                  <!-- User location map -->
                  <p>Your are in <strong>{{ city }}</strong>,<strong>{{ country }}</strong> based on your ip address.</p>
                  <iframe 
                        frameborder="0"
                       style="border:0; width:100%; height:100%; object-fit: cover;"
                       src="https://www.google.com/maps/embed/v1/view?center={{ latitude }},{{ longitude }}&zoom=8&key={{ api_key }}"
                       allowfullscreen>
                  </iframe>
              </div>
              <div class="col">
                  <div class="container" style="background:white;">
                      <div class="container" style="padding: 10px;">
                        <h5 style="text-align: center; color: blue; display: inline-block; padding-right: 30%;">Doctor's report</h5> 
                        {% if user.is_doctor %} 
                        <button class="btn btn-primary" style="display: inline-block;" data-toggle="modal" data-target="#reportform" >Add Report</button> 
                        {% endif %}                     
                      </div>                      
                      <table class="table table-hover">                                                    
                        <tbody>                                                    
                          <tr>                                
                            <td colspan="3" style="font-weight: bold;">Temperature</td>                                
                            {% if patient_report.temp %}
                            <td> {{patient_report.temp}} °C</td>
                            {% else %}
                            <td>--°C</td>                            
                            {% endif %}
                          </tr>
                          <tr>
                            <td colspan="3" style="font-weight: bold;">Test No.</td>                                                                
                            {% if patient_report.kit %}
                            <td> {{patient_report.kit}}</td>
                            {% else %}
                            <td>----</td>                            
                            {% endif %}
                          </tr>         
                          <tr>
                            <td style="font-weight: bold;">Comment</td>                                
                            {% if patient_report.comments %}
                              <td colspan="4">
                                {{patient_report.comments | safe}}
                                <p style="font-size: 12px; color: grey; margin-left: 60%;">Dr. {{patient_report.doctor}}</p>
                              </td>
                            {% else %}
                              <td colspan="4"> No comments yet.</td>
                            {% endif %}
                          </tr>                                               
                        </tbody>                                                                        
                      </table>
                  </div>
              </div>
              
              <!-- Edit Health Report Modal -->
              {% if user.is_doctor %}
              <div class="modal fade" id="reportform" tabindex="-1" role="dialog" aria-labelledby="reportform" aria-hidden="true" >
                <div class="modal-dialog modal-lg modal-dialog-centered" role="document"  style="background:url('https://images.unsplash.com/photo-1581299327801-faeb40ea459e?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=1171&q=80')">
                  <div class="modal-content" style="background:white;" >
                    <div class="modal-header">
                      <h4 class="modal-title" style="margin-left: 40%;">Doctor's Report</h4>
                      <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div> 
                    <div class="modal-body">
                      <div class="container" style="text-align: center; width:80%;">
                        <form action="{% url 'profile' %}" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                        
                            {% bootstrap_form reportform %}
                            <input type="submit" class="btn btn-success btn-lg" value="Update">
                        </form> 
                      </div>
                    </div>    
                  </div>
                </div>
              {% endif %}  
            </div> 
            <div class="container" style="background: white; margin-top:15vh;">
              <h5>Contacts:</h5>
            </div>
        </div>
        <div class="col"></div>
    </div>    
{% bootstrap_javascript %}
<!-- <script>
  function initMap(){
    var options = {
      zoom:8,
      center:{lat:-0.0236,lng:37.9062}
    }

    var map = new google.maps.Map(document.getElementById('map'), options);

    var marker = new google.maps.Marker({
      position:{lat:0.0074,lng:37.0722},
      map:map
    });
  }
</script>
<script defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAi2WMAlh_ol-sywUolU9RcBu4EMYvkmhU&callback=initMap">
    </script> -->
{% endblock %}

